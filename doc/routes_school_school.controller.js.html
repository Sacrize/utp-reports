<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: routes/school/school.controller.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: routes/school/school.controller.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>//@ts-check
/** @namespace routes/school */
const mongoose = require("mongoose");
const _ = require("lodash");
const {
  isAuthenticated,
} = require("../../middleware");

const classes = [{
    _id: 1,
    branch: "Wydział Telekomunikacji, Informatyki i Elektrotechniki ",
    specialization: "Informatyka stosowana",
    typeOfStudy: "Studia Niestacjonarne Pierwszego Stopnia",
    semester: "Rok 1 Semestr I (zimowy) rok akademicki 2017/2018",
  },
  {
    _id: 2,
    branch: "Wydział Telekomunikacji, Informatyki i Elektrotechniki ",
    specialization: "Informatyka stosowana",
    typeOfStudy: "Studia Stacjonarne Pierwszego Stopnia",
    semester: "Rok 1 Semestr II (letni) rok akademicki 2017/2018",
  },
];

/**
 * School Contoller
 * @param {object} router
 */
module.exports = (router) => {
  /**
   * Zwraca listę wszystkich wydziałów UTP. Na razie ze statycznej listy.
   *
   * @name getSchoolBranches
   * @memberof routes/school
   * @path {GET} /school/branches
   * @code {200} Jeśli wszystko jest ok.
   * @response {Array} branches Lista wydziałów z unikatowymi elementami (string).
   */
  router.get("/school/branches",
    isAuthenticated,
    /**
     * @param {object} req
     * @param {object} res
     */
    async (req, res) => {
      let branches = _.uniqBy(classes, "branch").map(c => c.branch);
      res.status(200).send(branches);
    },
  );
  /**
   * Zwraca listę wszystkich kierunków na wydziale UTP.
   *
   * @name getSchoolSpecializations
   * @memberof routes/school
   * @path {GET} /school/specializations
   * @query {String} branch Wydział UTP.
   * @code {200} Jeśli wszystko jest ok.
   * @code {400} Jeśli podany wydział jest błędny.
   * @response {Array} branches Lista kierunków z unikatowymi elementami (string).
   */
  router.get("/school/specializations",
    isAuthenticated,
    /**
     * @param {object} req
     * @param {object} res
     */
    async (req, res) => {
      let branch = req.query.branch;

      if (!branch || _.isString(branch) === false) {
        return res.status(400).send("bad request");
      }

      let branches = _.filter(classes, ["branch", branch]);
      let specializations = _.uniqBy(branches, "specialization").map(c => c.specialization);
      res.status(200).send(specializations);
    },
  );
  /**
   * Zwraca listę wszystkich typów studiów danego kierunku na wydziale UTP.
   *
   * @name getSchoolTypesOfStudy
   * @memberof routes/school
   * @path {GET} /school/typesofstudy
   * @query {String} branch Wydział UTP.
   * @query {String} specialization Kierunek na wydziale UTP.
   * @code {200} Jeśli wszystko jest ok.
   * @code {400} Jeśli podany wydział lub kierunek jest błędny.
   * @response {Array} typesOfStudy Lista typów z unikatowymi elementami (string).
   */
  router.get("/school/typesofstudy",
    isAuthenticated,
    /**
     * @param {object} req
     * @param {object} res
     */
    async (req, res) => {
      let branch = req.query.branch;
      let specialization = req.query.specialization;

      if (!branch || _.isString(branch) === false) {
        return res.status(400).send("bad request");
      }

      if (!specialization || _.isString(specialization) === false) {
        return res.status(400).send("bad request");
      }

      let branches = _.filter(classes, ["branch", branch]);
      let specializations = _.filter(branches, ["specialization", specialization]);
      let typesOfStudy = _.uniqBy(specializations, "typeOfStudy").map(c => c.typeOfStudy);
      res.status(200).send(typesOfStudy);
    },
  );
  /**
   * Zwraca listę wszystkich semestrów zależnie od typów studiów danego kierunku na wydziale UTP.
   *
   * @name getSchoolSemesters
   * @memberof routes/school
   * @path {GET} /school/semesters
   * @query {String} branch Wydział UTP.
   * @query {String} specialization Kierunek na wydziale UTP.
   * @query {String} typeOfStudy Typ studiów danego kieruneku na wydziale UTP.
   * @code {200} Jeśli wszystko jest ok.
   * @code {400} Jeśli podany wydział lub kierunek jest błędny.
   * @response {Array} semesters Lista semestrów z unikatowymi elementami (string).
   */
  router.get("/school/semesters",
    isAuthenticated,
    /**
     * @param {object} req
     * @param {object} res
     */
    async (req, res) => {
      let branch = req.query.branch;
      let specialization = req.query.specialization;
      let typeOfStudy = req.query.typesOfStudy;

      if (!branch || _.isString(branch) === false) {
        return res.status(400).send("bad request");
      }

      if (!specialization || _.isString(specialization) === false) {
        return res.status(400).send("bad request");
      }

      if (!typeOfStudy || _.isString(typeOfStudy) === false) {
        return res.status(400).send("bad request");
      }

      let branches = _.filter(classes, ["branch", branch]);
      let specializations = _.filter(branches, ["specialization", specialization]);
      let typesOfStudy = _.filter(specializations, ["typeOfStudy", typeOfStudy]);
      let semesters = _.uniqBy(typesOfStudy, "semester").map(c => c.semester);
      res.status(200).send(semesters);
    },
  );
};
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Config.html">Config</a></li></ul><h3>Namespaces</h3><ul><li><a href="components_createExercise.html">components/createExercise</a></li><li><a href="components_uploadReport.html">components/uploadReport</a></li><li><a href="middlewares.html">middlewares</a></li><li><a href="routes_auth.html">routes/auth</a></li><li><a href="routes_exercise.html">routes/exercise</a></li><li><a href="routes_reports.html">routes/reports</a></li><li><a href="routes_school.html">routes/school</a></li><li><a href="routes_student.html">routes/student</a></li><li><a href="routes_teacher.html">routes/teacher</a></li><li><a href="services.html">services</a></li><li><a href="utils.html">utils</a></li><li><a href="views_auth.html">views/auth</a></li><li><a href="views_student.html">views/student</a></li><li><a href="views_teacher.html">views/teacher</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Thu Jun 14 2018 17:56:24 GMT+0200 (CEST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
